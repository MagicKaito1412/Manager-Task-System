<div class="x-tree">
{{#if presenter.options.showTitle}}
	{{#if title}}
		<div class="x-part-title x-tree-title">{{title}}</div>
	{{/if}}
{{/if}}

{{#if filter}}
    <div class="x-filter-container x-tree-filter-container" id="{{push-id}}">
        {{#if options.filterCollapsable}}
            {{part class="ui.ExpandablePanel" body=filter expandedProp="filterExpanded" expandTitle=options.expandFilterTitle collapseTitle=options.collapseFilterTitle target=":pop-id"}}
        {{else}}
            {{render filter}}
        {{/if}}
    </div>
{{/if}}

{{#if-not presenter.options.hideMenuTree}}
<div class="x-tree-menu-tree {{presenter.options.menuTreeCssClass}}" id="{{push-id}}">
    {{#observe this target=":pop-id"}}
        {{#if-menu menuTree}}
            <div id="{{push-id}}">{{part class="ui.MenuPresenter" viewModel=menuTree target=":pop-id"}}</div>
        {{/if-menu}}
    {{/observe}}
</div>
{{/if-not}}
<div class="x-tree-hint-container" id="{{push-id}}">
    {{#observe this target=":pop-id"}}
        {{#if hintMessage}}
            <div class='alert alert-info alert-dismissible fade in '>
                <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                {{{hintMessage}}}
            </div>
        {{/if}}
    {{/observe}}
</div>

<div class="x-tree-body">
    <div class="x-tree-data" {{data-bind visibility="this.root().state() === 'loaded' && this.root().children().count()"}}>
        <table class="x-tree-data-table">
            {{#with presenter}}
            <colgroup>
                {{#if options.hasCheckboxes}}<col />{{/if}}
                {{#if options.hasNumbering}}<col />{{/if}}
                <col width="100%" />
            </colgroup>
            <thead style="display: none">
            <tr>
                {{#if options.hasCheckboxes}}<th></th>{{/if}}
                {{#if options.hasNumbering}}<th></th>{{/if}}
                <th></th>
            </tr>
            </thead>
            {{/with}}
            <tbody></tbody>
        </table>
    </div>
    {{#observe this.root tag="div"}}
        {{#compare state "===" "loading"}}
            {{waiting-large}}
        {{/compare}}
        {{#compare state "===" "initial"}}
            <p class="x-tree-state-message text-info">{{{../options.strings.not_loaded}}}</p>
            {{command-bind ../commands.ReloadRoot target=".x-tree-state-message .x-cmd-link"}}
        {{/compare}}
        {{#compare state "===" "failed"}}
            <p class="x-tree-state-message text-danger">{{{../options.strings.load_failed}}}{{#if message}}:<br>{{message}}{{/if}}</p>
        {{/compare}}
        {{#compare state "===" "loaded"}}
            {{#if-not children.count}}
                <p class="x-tree-state-message text-success">{{{../options.strings.no_data}}}</p>
            {{/if-not}}
        {{/compare}}
    {{/observe}}
</div>

{{#if-not presenter.options.hideMenuNode}}
<div class="x-tree-menu-node {{presenter.options.menuNodeCssClass}}">
    {{#observe this target=".x-tree-menu-node"}}
        {{#if-menu menuSelection}}
            <div id="{{push-id}}" class="pull-left" {{data-bind transparent="this.root().state() === 'loading'" target=":peek-id"}}>
                {{part class="ui.MenuPresenter" viewModel=menuSelection target=":pop-id" dropup=true}}
                {{data-bind text="this.selection().count()" target=".x-tree-menu-selection-counter"}}
            </div>
        {{/if-menu}}
        {{#if-menu menuNode}}
            <div id="{{push-id}}" class="pull-right" {{data-bind transparent="this.root().state() === 'loading'" target=":peek-id"}}>
                {{part class="ui.MenuPresenter" viewModel=menuNode target=":pop-id" dropup=true}}
            </div>
        {{/if-menu}}
    {{/observe}}
</div>
{{/if-not}}

</div>
